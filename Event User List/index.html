<!DOCTYPE html>
<html>
  <head>
      <meta name="viewport" content="width=1, initial-scale=1">

    <base target="_top">
    <link rel='stylesheet' href='https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css'>
    <script>
      function updateTable() {
        google.script.run.withSuccessHandler(function(data) {
          var tbody = document.querySelector('#table-body');
          tbody.innerHTML = '';
          data.forEach(function(rowData) {
            var tr = document.createElement('tr');
            rowData.splice(3, 1);
            rowData.splice(2, 1);
            rowData.forEach(function(cellData) {
              var td = document.createElement('td');
              td.innerHTML = cellData;
              tr.appendChild(td);
            });
            tbody.appendChild(tr);
          });
        }).getTableData();
      }
      setInterval(updateTable, 1000); //每1000ms 刷新一次updatetable function
      window.addEventListener('load', updateTable); 
    </script>
  </head>
  <body>
      <br>
    <div class='container'>
      <center><h1>USER LIST</h1></center>
      <table class='table table-bordered'>
        <thead class='thead-dark'>
          <tr>
            <th>No</th>
            <th>Phone_Number</th>
            <th>Name</th>
            <th>Table_No</th>
            <th>Category</th>
            <th>Description</th>
            <th>QR_Code</th>
          </tr>
        </thead>
        <tbody id='table-body'>
          <? for (var i = 0; i < data.length; i++) { ?>
            <tr>
              <? for (var j = 0; j < data[i].length; j++) { ?>
                <td><?= data[i][j] ?></td>
              <? } ?>
            </tr>
          <? } ?>
        </tbody>
      </table>
    </div>
  </body>
</html>

